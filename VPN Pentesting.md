### Ramya Ajay
### CB.EN.P2CYS22004
#  Lab Assignment 4
## Creating an IPsec-based VPN with the help of the Strongswan tool.

### Enabling kernel packet forwarding 

`sudo vi /etc/sysctl.conf`

<img width="179" alt="Screenshot 2023-04-23 133812" src="https://user-images.githubusercontent.com/123251017/234612237-ba4f2681-d820-4d38-8cbf-836ad7ccd618.png">
<img width="214" alt="Screenshot 2023-04-23 133904" src="https://user-images.githubusercontent.com/123251017/234612289-ce932dc3-4ba5-488b-9336-61571f78267e.png">


### Installing / Enabling Strongswan tool

`sudo systemctl enable strongswan-starter`

`sudo systemctl status strongswan-starter`

<img width="443" alt="Screenshot 2023-04-23 133811" src="https://user-images.githubusercontent.com/123251017/234612560-fb7478c6-4c3e-4a4e-9a0d-a4a739cd4a08.png">


### Configuring security gateways

`sudo vi /etc/ipsec.conf`

> Kali linux IP - 10.0.2.10

> Purple Kali linux IP - 10.0.2.10

<img width="941" alt="Screenshot 2023-04-23 134125" src="https://user-images.githubusercontent.com/123251017/234612768-a9bc1bbf-bbe2-4a1c-9d46-9dbe3bc15860.png">
<img width="958" alt="Screenshot 2023-04-23 133959" src="https://user-images.githubusercontent.com/123251017/234612935-b484f153-e534-443c-bc5f-58557ddbbedd.png">

* config setup – specifies general configuration information for IPSec which applies to all connections.
* charondebug – defines how much Charon debugging output should be logged.
* uniqueids – specifies whether a particular participant ID should be kept unique.
* conn prodgateway-to-devgateway – defines connection name.
* type – defines connection type.
* auto – how to handle connection when IPSec is started or restarted.
* keyexchange – defines the version of the IKE protocol to use.
* authby – defines how peers should authenticate each other.
* left – defines the IP address of the left participant’s public-network interface.
* right – specifies the IP address of the right participant’s public-network interface.
* ike – defines a list of IKE/ISAKMP SA encryption/authentication algorithms to be used. You can add a comma-separated list.
* esp – defines a list of ESP encryption/authentication algorithms to be used for the connection. You can add a comma-separated list.
* aggressive – states whether to use Aggressive or Main Mode.
* keyingtries – states the number of attempts that should be made to negotiate a connection.
* ikelifetime – states how long the keying channel of a connection should last before being renegotiated.
* lifetime – defines how long a particular instance of a connection should last, from successful negotiation to expiry.
* dpddelay – specifies the time interval with which R_U_THERE messages/INFORMATIONAL exchanges are sent to the peer.
* dpdtimeout – specifies the timeout interval, after which all connections to a peer are deleted in case of inactivity.
* dpdaction – defines how to use the Dead Peer Detection(DPD) protocol to manage the connection.

### Configuring PSK for Peer-to-Peer Authentication.

`sudo vi /etc/ipsec.secrets`

<img width="954" alt="Screenshot 2023-04-23 134045" src="https://user-images.githubusercontent.com/123251017/234613062-84ca404d-0f47-4444-879e-dfdcd9d923d2.png">

### Establishing connection between two gateways

`sudo ipsec restart`

`sudo ipsec up <config-name>`

<img width="923" alt="Screenshot 2023-04-23 133654" src="https://user-images.githubusercontent.com/123251017/234613165-01db3a51-46bf-488e-b9be-5375ec08c146.png">

### Pentesting using nmap

<img width="908" alt="Screenshot 2023-04-23 135337" src="https://user-images.githubusercontent.com/123251017/234613484-609e0a78-20f0-423b-86f2-a174c4e1de33.png">
<img width="928" alt="Screenshot 2023-04-23 150339" src="https://user-images.githubusercontent.com/123251017/234613543-b4cc022c-d33d-4a67-b0c4-2868c302b0f6.png">
<img width="833" alt="Screenshot 2023-04-23 150533" src="https://user-images.githubusercontent.com/123251017/234613610-f87694c9-a537-462a-b540-e50caced27f2.png">
<img width="824" alt="Screenshot 2023-04-23 150644" src="https://user-images.githubusercontent.com/123251017/234613695-3b83a309-f821-497a-8d01-0caad34dfd9f.png">
<img width="925" alt="Screenshot 2023-04-23 150731" src="https://user-images.githubusercontent.com/123251017/234613739-dfbe1ae2-6888-44de-a9dd-d6d1aacad71c.png">
<img width="816" alt="Screenshot 2023-04-23 150919" src="https://user-images.githubusercontent.com/123251017/234613793-8f54e368-bd1c-40fa-bb6c-715e62f6d87b.png">

